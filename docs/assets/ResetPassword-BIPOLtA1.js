import{u as e}from"./username-Dv10iimS.js";import{u as s}from"./overlayPosition-DBiKvfLA.js";import{u as a}from"./vue-router-CV1PYoGq.js";import{r}from"./user-xCAwdfj3.js";import{a as o}from"./ant-design-vue-D6vHO1DM.js";import{d as t,r as i,h as d,S as n,e as l,bI as m,z as p,u,bB as f,bC as c,bM as w,V as v,bv as _}from"./vendor-CKpYW6Oo.js";import{_ as g}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./pinia-DPBO3wPh.js";import"./request-Be5djaOi.js";const h={ref:"signFormRef",class:"reset-container form-container half-width"},j=g(t({__name:"ResetPassword",setup(t){const[g,j]=o.useMessage(),b=a(),y=e(),P=s(),x=i({id:void 0,password1:"",password2:""}),k=d(),I={password1:[{required:!0,validator:async(e,s)=>""===s?Promise.reject("请输入密码！"):(""!==x.password2&&k.value?.validateFields("password2"),Promise.resolve()),trigger:"change"}],password2:[{required:!0,validator:async(e,s)=>""===s?Promise.reject("请再次输入密码！"):s!==x.password1?Promise.reject("两次输入的密码不一致！"):Promise.resolve(),trigger:"change"}]};n((()=>{y.Id?x.id=y.Id:(y.setUsername(void 0),b.replace({name:"resetValidate"}))}));const q=l((()=>!(x.id&&x.password1&&x.password2)));async function F(){const e={id:x.id,newPassword:x.password1,newPasswordAgain:x.password2};try{await r(e),g.info("密码重置成功，即将跳转登录页..."),setTimeout((()=>{P.resetPosition(),b.replace({name:"inputPassword"})}),2e3)}catch(s){}}return(e,s)=>{const a=c("a-input-password"),r=c("a-form-item"),o=c("a-button"),t=c("a-form"),i=c("a-flex");return _(),m("div",h,[p(u(j)),p(i,{justify:"center",align:"center",vertical:!0,style:{height:"100%"}},{default:f((()=>[p(t,{ref_key:"formRef",ref:k,model:x,rules:I,onFinish:F},{default:f((()=>[p(r,{"has-feedback":"",label:"输入新密码",name:"password1"},{default:f((()=>[p(a,{value:x.password1,"onUpdate:value":s[0]||(s[0]=e=>x.password1=e)},{prefix:f((()=>[p(u(w),{class:"site-form-item-icon"})])),_:1},8,["value"])])),_:1}),p(r,{"has-feedback":"",label:"请确认密码",name:"password2"},{default:f((()=>[p(a,{value:x.password2,"onUpdate:value":s[1]||(s[1]=e=>x.password2=e)},{prefix:f((()=>[p(u(w),{class:"site-form-item-icon"})])),_:1},8,["value"])])),_:1}),p(r,null,{default:f((()=>[p(o,{disabled:q.value,type:"primary","html-type":"submit",style:{width:"100%"}},{default:f((()=>s[2]||(s[2]=[v(" 重置密码 ")]))),_:1,__:[2]},8,["disabled"])])),_:1})])),_:1},8,["model"])])),_:1})],512)}}}),[["__scopeId","data-v-3c317447"]]);export{j as default};
